(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     90740,       2142]
NotebookOptionsPosition[     88346,       2058]
NotebookOutlinePosition[     88752,       2076]
CellTagsIndexPosition[     88709,       2073]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["init: collection of functions used", "Section",
 InitializationGroup->True,
 CellChangeTimes->{{3.5001245513715477`*^9, 3.500124561017185*^9}, {
  3.502619244214007*^9, 3.5026192450282583`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GenerateROCsmart", "[", 
    RowBox[{"xadjA_", ",", 
     RowBox[{"adjA_:", "adjA"}], ",", 
     RowBox[{"focusXcoord_:", "False"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "xdata", ",", "xmin", ",", "xmax", ",", "xROCpoints", ",", "oldRL"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "@", "xadjA"}], "\[NotEqual]", 
         RowBox[{"Dimensions", "@", "adjA"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<GenerateROCsmart error: Dimensions of input matrices do not \
match\>\"", "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"xROCpoints", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xdata", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"Sort", "@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"ii", "\[NotEqual]", "jj"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"adjA", "\[LeftDoubleBracket]", 
                   RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}], ",", 
                  
                  RowBox[{"xadjA", "\[LeftDoubleBracket]", 
                   RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}]}], 
                 "}"}], ",", 
                RowBox[{"{", "\"\<nix\>\"", "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", 
                RowBox[{"Length", "@", "adjA"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"jj", ",", 
                RowBox[{"Length", "@", "adjA"}]}], "}"}]}], "]"}], ",", "1"}],
            "]"}]}], ",", 
         RowBox[{"{", "\"\<nix\>\"", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"xmin", "=", 
       RowBox[{"N", "@", 
        RowBox[{"Min", "@", 
         RowBox[{"Last", "@", 
          RowBox[{"Transpose", "@", "xdata"}]}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xmax", "=", 
       RowBox[{"N", "@", 
        RowBox[{"Max", "@", 
         RowBox[{"Last", "@", 
          RowBox[{"Transpose", "@", "xdata"}]}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"xmax", "-", "xmin"}], "<", 
           SuperscriptBox["10", 
            RowBox[{"-", "9"}]]}], ",", 
          RowBox[{"Abort", "[", "]"}]}], "]"}], ";"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"xmax", "-", "xmin"}], ">", 
         SuperscriptBox["10", 
          RowBox[{"-", "9"}]]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"oldRL", "=", "$RecursionLimit"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"$RecursionLimit", "=", "1000"}], ";", "\[IndentingNewLine]", 
         RowBox[{"xROCpoints", "=", 
          RowBox[{"GenerateROCrecursive", "[", 
           RowBox[{"xdata", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", "xmax", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], ",", "xmin", ",", "xROCpoints", 
            ",", "0.04", ",", "1", ",", "focusXcoord"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"$RecursionLimit", "=", "oldRL"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "@", 
       RowBox[{"Sort", "@", "xROCpoints"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateROCrecursive", "[", 
    RowBox[{
    "xdata_", ",", "left_", ",", "xmax_", ",", "right_", ",", "xmin_", ",", 
     "xROCpoints_", ",", "minDist2D_", ",", "recursionDepth_Integer", ",", 
     RowBox[{"focusXcoord_:", "False"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "xx", ",", "xP", ",", "xTP", ",", "xN", ",", "xFP", ",", 
       "xROCpointsLocal", ",", "middle"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"xROCpointsLocal", "=", "xROCpoints"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "go", " ", "through", " ", "all", " ", "possible", " ", "threshold", 
        " ", "values", " ", "and", " ", "compute", " ", "the", " ", "ROC", 
        " ", "data", " ", "points"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"xx", "=", 
       RowBox[{"N", "@", 
        FractionBox[
         RowBox[{"xmin", "+", "xmax"}], "2"]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"xP", "=", 
       RowBox[{"Length", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"xdata", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "_"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xTP", "=", 
       RowBox[{"Length", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"xdata", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#", ">", "xx"}], ")"}], "&"}], ")"}]}]}], "}"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xN", "=", 
       RowBox[{"Length", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"xdata", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "_"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xFP", "=", 
       RowBox[{"Length", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"xdata", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#", ">", "xx"}], ")"}], "&"}], ")"}]}]}], "}"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"middle", "=", 
       RowBox[{"N", "@", 
        RowBox[{"{", 
         RowBox[{
          FractionBox["xFP", "xN"], ",", 
          FractionBox["xTP", "xP"]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"xROCpointsLocal", ",", "middle"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<New ROC point: \>\"", "<>", 
          RowBox[{"ToString", "@", "middle"}], "<>", "\"\<, xx=\>\"", "<>", 
          RowBox[{"ToString", "@", 
           RowBox[{"InputForm", "@", "xx"}]}], "<>", "\"\<, left=\>\"", "<>", 
          
          RowBox[{"ToString", "@", "left"}], "<>", "\"\<, xmin=\>\"", "<>", 
          RowBox[{"ToString", "@", 
           RowBox[{"InputForm", "@", "xmin"}]}], "<>", "\"\<, right=\>\"", "<>", 
          RowBox[{"ToString", "@", "right"}], "<>", "\"\<, xmax=\>\"", "<>", 
          RowBox[{"ToString", "@", 
           RowBox[{"InputForm", "@", "xmax"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Pause", "[", "0.1", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "@", 
            RowBox[{"Cases", "[", 
             RowBox[{"xdata", ",", 
              RowBox[{"{", 
               RowBox[{"_", ",", 
                RowBox[{"_", "?", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", ">", "xmin"}], ")"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{"#", "<", "xmax"}], ")"}]}], "&"}], ")"}]}]}], 
               "}"}]}], "]"}]}], ">", "1"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{"recursionDepth", "<", "20"}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{"middle", "-", "left"}], "]"}], ">", "minDist2D"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"focusXcoord", "\[Equal]", "False"}], ")"}], "||", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"First", "@", "left"}], "\[LessEqual]", 
                  "focusXcoord"}], ")"}], "&&", 
                RowBox[{"(", 
                 RowBox[{"focusXcoord", "\[LessEqual]", 
                  RowBox[{"First", "@", "middle"}]}], ")"}]}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"xROCpointsLocal", "=", 
              RowBox[{"GenerateROCrecursive", "[", 
               RowBox[{
               "xdata", ",", "left", ",", "xmax", ",", "middle", ",", "xx", 
                ",", "xROCpointsLocal", ",", "minDist2D", ",", 
                RowBox[{"recursionDepth", "+", "1"}], ",", "focusXcoord"}], 
               "]"}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{"right", "-", "middle"}], "]"}], ">", "minDist2D"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"focusXcoord", "\[Equal]", "False"}], ")"}], "||", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"First", "@", "middle"}], "\[LessEqual]", 
                  "focusXcoord"}], ")"}], "&&", 
                RowBox[{"(", 
                 RowBox[{"focusXcoord", "\[LessEqual]", 
                  RowBox[{"First", "@", "right"}]}], ")"}]}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"xROCpointsLocal", "=", 
              RowBox[{"GenerateROCrecursive", "[", 
               RowBox[{
               "xdata", ",", "middle", ",", "xx", ",", "right", ",", "xmin", 
                ",", "xROCpointsLocal", ",", "minDist2D", ",", 
                RowBox[{"recursionDepth", "+", "1"}], ",", "focusXcoord"}], 
               "]"}]}]}], "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "xROCpointsLocal"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GenerateROCsmartVector", "[", 
     RowBox[{"xoriginal_", ",", "xrec_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "xdata", ",", "xmin", ",", "xmax", ",", "xROCpoints", ",", "oldRL"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xROCpoints", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"xdata", "=", 
        RowBox[{"Transpose", "@", 
         RowBox[{"{", 
          RowBox[{"xoriginal", ",", "xrec"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"xmin", "=", 
        RowBox[{"N", "@", 
         RowBox[{"Min", "@", 
          RowBox[{"Last", "@", 
           RowBox[{"Transpose", "@", "xdata"}]}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"xmax", "=", 
        RowBox[{"N", "@", 
         RowBox[{"Max", "@", 
          RowBox[{"Last", "@", 
           RowBox[{"Transpose", "@", "xdata"}]}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"xmax", "-", "xmin"}], "<", 
            SuperscriptBox["10", 
             RowBox[{"-", "9"}]]}], ",", 
           RowBox[{"Abort", "[", "]"}]}], "]"}], ";"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"xmax", "-", "xmin"}], ">", 
          SuperscriptBox["10", 
           RowBox[{"-", "9"}]]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"oldRL", "=", "$RecursionLimit"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"$RecursionLimit", "=", "1000"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"xROCpoints", "=", 
           RowBox[{"GenerateROCrecursive", "[", 
            RowBox[{"xdata", ",", 
             RowBox[{"{", 
              RowBox[{"0.", ",", "0"}], "}"}], ",", "xmax", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}], ",", "xmin", ",", "xROCpoints", 
             ",", "0.04"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"$RecursionLimit", "=", "oldRL"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Sort", "@", "xROCpoints"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReduceForInterpolation", "[", "xdataIn_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ii", ",", "xdata", ",", "xdata2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xdata", "=", 
       RowBox[{"N", "@", "xdataIn"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xdata2", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"ii", "=", "1"}], ",", 
        RowBox[{"ii", "\[LessEqual]", 
         RowBox[{"Length", "@", "xdata"}]}], ",", 
        RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", 
            RowBox[{"Cases", "[", 
             RowBox[{"xdata2", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xdata", "\[LeftDoubleBracket]", 
                 RowBox[{"ii", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                "_"}], "}"}]}], "]"}]}], "\[Equal]", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"xdata2", ",", 
            RowBox[{
            "xdata", "\[LeftDoubleBracket]", "ii", 
             "\[RightDoubleBracket]"}]}], "]"}]}], "\[IndentingNewLine]", 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", "xdata2"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TPat10FP", "[", 
    RowBox[{"xadjA_", ",", "trueadjA_", ",", 
     RowBox[{"xcoord_:", "0.1"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"ReduceForInterpolation", "@", 
       RowBox[{"N", "@", 
        RowBox[{"GenerateROCsmart", "[", 
         RowBox[{"xadjA", ",", "trueadjA", ",", "xcoord"}], "]"}]}]}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "xcoord", 
    "]"}]}], ";"}]}], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.480767279108342*^9, 3.480767280764413*^9}, {
   3.480767315193233*^9, 3.480767437847006*^9}, {3.4807674824079437`*^9, 
   3.4807677886478367`*^9}, {3.4807678556267776`*^9, 3.480768030241831*^9}, {
   3.48076809521441*^9, 3.480768126321455*^9}, {3.480770699356887*^9, 
   3.480770712495242*^9}, {3.480770744043462*^9, 3.48077078513273*^9}, 
   3.48077083622727*^9, {3.480770930612818*^9, 3.4807709344927263`*^9}, {
   3.4807709668638687`*^9, 3.480770994743442*^9}, {3.480771025679805*^9, 
   3.480771051674094*^9}, {3.480771084499555*^9, 3.480771085921994*^9}, {
   3.4807711302147503`*^9, 3.480771136720929*^9}, {3.480771324765935*^9, 
   3.480771342024645*^9}, {3.480831034679968*^9, 3.480831049759921*^9}, {
   3.480831810615596*^9, 3.480831895711688*^9}, {3.4808319402574663`*^9, 
   3.4808319657675667`*^9}, {3.480832004770133*^9, 3.480832109853163*^9}, {
   3.480832286030952*^9, 3.4808323066201067`*^9}, {3.480832337944866*^9, 
   3.480832363341411*^9}, {3.480832474269555*^9, 3.480832492657324*^9}, {
   3.480832539975679*^9, 3.480832574257802*^9}, {3.4808326582357273`*^9, 
   3.480832666663755*^9}, {3.480832729895268*^9, 3.480832744454007*^9}, {
   3.4808327989685698`*^9, 3.4808328091981497`*^9}, {3.480832967174185*^9, 
   3.480832978819231*^9}, {3.48083370272721*^9, 3.480833710134932*^9}, {
   3.480833987403469*^9, 3.480833990593966*^9}, {3.480834033736928*^9, 
   3.480834035318328*^9}, 3.480834078059885*^9, {3.480840839779895*^9, 
   3.4808408420112658`*^9}, {3.480843920660255*^9, 3.480843975260869*^9}, {
   3.480844056211101*^9, 3.480844056409719*^9}, 3.4808441272693768`*^9, {
   3.480844947327795*^9, 3.480844976566415*^9}, {3.48084510419881*^9, 
   3.480845136169456*^9}, {3.480845215071433*^9, 3.480845218125535*^9}, {
   3.4808452644109793`*^9, 3.480845265267057*^9}, {3.48084534622388*^9, 
   3.4808453489308777`*^9}, {3.480845380204666*^9, 3.480845380305511*^9}, {
   3.480845481003648*^9, 3.480845487754582*^9}, {3.480845529869125*^9, 
   3.480845531691133*^9}, {3.480845804697489*^9, 3.4808458674038*^9}, {
   3.4808459156210833`*^9, 3.480845922498361*^9}, 3.480846036318314*^9, {
   3.480846095361952*^9, 3.4808461157502947`*^9}, {3.4808462749714203`*^9, 
   3.480846280440401*^9}, 3.4808463201660967`*^9, {3.480847775446396*^9, 
   3.480847793811833*^9}, {3.480847974347226*^9, 3.480847977414671*^9}, {
   3.480848010247305*^9, 3.480848041792604*^9}, {3.480848344936551*^9, 
   3.480848370445671*^9}, {3.480848682451395*^9, 3.480848686649908*^9}, {
   3.4808525760435762`*^9, 3.480852603614744*^9}, {3.480933840900691*^9, 
   3.480933842401801*^9}, 3.482519728699498*^9, 3.4825197813328753`*^9, {
   3.483078457522393*^9, 3.483078519886224*^9}, 3.4861216598186083`*^9, {
   3.486128352951619*^9, 3.4861283539461184`*^9}, {3.486129033917575*^9, 
   3.486129058745846*^9}, 3.48612983314592*^9, 3.486129863208269*^9, {
   3.4907703170456657`*^9, 3.490770337788011*^9}, {3.4907703682474947`*^9, 
   3.490770398974257*^9}, {3.498141386610293*^9, 3.498141387084379*^9}, {
   3.498206862628512*^9, 3.498206899254554*^9}, {3.498206974531167*^9, 
   3.498206974618392*^9}, {3.498207092162856*^9, 3.498207102696241*^9}, {
   3.4982071681993437`*^9, 3.498207193954982*^9}, {3.5142610665025597`*^9, 
   3.514261093812058*^9}, {3.514871662493778*^9, 3.51487166794296*^9}, {
   3.514871700612928*^9, 3.51487176627321*^9}, {3.514871808841899*^9, 
   3.51487188801363*^9}, {3.514872003104885*^9, 3.514872141440753*^9}, {
   3.514872352793008*^9, 3.514872355290208*^9}, {3.514872387963114*^9, 
   3.514872390043391*^9}, {3.514872430465077*^9, 3.5148724342472267`*^9}, {
   3.514872775140564*^9, 3.514872775760867*^9}, {3.515509947748061*^9, 
   3.515510001203368*^9}, {3.5155100847321033`*^9, 3.515510085010352*^9}, {
   3.520053289423671*^9, 3.520053321008535*^9}, {3.520053354134266*^9, 
   3.520053385147366*^9}, {3.520053644914092*^9, 3.5200536738566103`*^9}, {
   3.5200537109599857`*^9, 3.5200537110507793`*^9}, {3.520053998873067*^9, 
   3.520054001644908*^9}, {3.520054064905422*^9, 3.520054065816346*^9}, {
   3.520054457287816*^9, 3.520054457397971*^9}, {3.5200610591027822`*^9, 
   3.5200610607438393`*^9}, {3.553758249363676*^9, 3.553758249462554*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CleanUpROCs", "[", "roc_List", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xrocN", ",", "xValues"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xrocN", "=", 
       RowBox[{"N", "[", 
        RowBox[{"roc", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xValues", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"xrocN", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#", ",", 
           RowBox[{"Last", "@", 
            RowBox[{"First", "@", 
             RowBox[{"Cases", "[", 
              RowBox[{"xrocN", ",", 
               RowBox[{"{", 
                RowBox[{"#", ",", "_"}], "}"}]}], "]"}]}]}]}], "}"}], "&"}], "/@",
         "xValues"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.587703378206593*^9, 3.587703379131867*^9}, {
  3.587704185183269*^9, 3.587704189541267*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TellMeWhatHappened", "[", "parslist_", "]"}], ":=", 
   RowBox[{"TellMeWhatHappened", "[", 
    RowBox[{"parslist", ",", 
     RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TellMeWhatHappened", "[", 
    RowBox[{"parslist_", ",", "maxit_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ii", ",", "jj", ",", "constantlist", ",", "length", ",", 
       "therewas1before"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"Union", "[", 
           RowBox[{"Length", "/@", "parslist"}], "]"}]}], "\[NotEqual]", 
         "1"}], ",", 
        RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"Dimensions", "@", "parslist"}]}], ">", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"length", "=", 
          RowBox[{"Length", "@", 
           RowBox[{"First", "@", "parslist"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"constantlist", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "@", 
                RowBox[{"Union", "[", 
                 RowBox[{"parslist", "\[LeftDoubleBracket]", 
                  RowBox[{"All", ",", "ii"}], "\[RightDoubleBracket]"}], 
                 "]"}]}], "\[Equal]", "1"}], ",", "True", ",", "False"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"ii", ",", "length"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "\"\<constant parameters:\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"Second", "@", 
           RowBox[{"Transpose", "@", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"{", 
                RowBox[{"constantlist", ",", 
                 RowBox[{"First", "@", "parslist"}]}], "}"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"True", ",", "_"}], "}"}]}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "\"\<variable parameters:\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"ii", "=", "1"}], ",", 
           RowBox[{"ii", "\[LessEqual]", 
            RowBox[{"Length", "@", "parslist"}]}], ",", 
           RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<#\>\"", ",", "ii", ",", "\"\<: \>\"", ",", 
              RowBox[{"Second", "@", 
               RowBox[{"Transpose", "@", 
                RowBox[{"Cases", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{"constantlist", ",", 
                    RowBox[{
                    "parslist", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"False", ",", "_"}], "}"}]}], "]"}]}]}]}], "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"maxit", ">", "0"}], ")"}], "&&", 
               RowBox[{"(", 
                RowBox[{"ii", "\[GreaterEqual]", "maxit"}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"\"\<(remaining \>\"", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{
                   RowBox[{"Length", "[", "parslist", "]"}], "-", "ii"}], 
                  "]"}], "<>", "\"\< iterations hidden.)\>\""}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<parameters: \>\"", ",", "parslist"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.498215869708056*^9, 3.4982164109421577`*^9}, {
   3.498217047710257*^9, 3.4982170536433887`*^9}, 3.4982170972345552`*^9, {
   3.498218401289304*^9, 3.498218435064172*^9}, {3.498218468551794*^9, 
   3.4982184893084803`*^9}, {3.500124983753242*^9, 3.5001251281226387`*^9}, {
   3.5001251715780697`*^9, 3.500125212557458*^9}, {3.502528213805126*^9, 
   3.502528214684104*^9}, 3.50262054229475*^9, {3.5026221278403273`*^9, 
   3.5026221333003798`*^9}, 3.50312581521247*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NTP", "[", 
    RowBox[{"adjAD_", ",", "trueadjA_"}], "]"}], ":=", 
   RowBox[{"Length", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"N", "@", 
          RowBox[{"Flatten", "@", 
           RowBox[{"RemoveDiagonal", "@", 
            RowBox[{"Normal", "@", "#"}]}]}]}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"adjAD", ",", "trueadjA"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1.", ",", "1."}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NFP", "[", 
    RowBox[{"adjAD_", ",", "trueadjA_"}], "]"}], ":=", 
   RowBox[{"Length", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"N", "@", 
          RowBox[{"Flatten", "@", 
           RowBox[{"RemoveDiagonal", "@", 
            RowBox[{"Normal", "@", "#"}]}]}]}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"adjAD", ",", "trueadjA"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1.", ",", "0."}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PPCpoint", "[", 
    RowBox[{"adjAD_", ",", "trueadjA_", ",", "numberOfLinks_"}], "]"}], ":=", 
   
   FractionBox[
    RowBox[{
     RowBox[{"NTP", "[", 
      RowBox[{"adjAD", ",", "trueadjA"}], "]"}], "-", 
     RowBox[{"NFP", "[", 
      RowBox[{"adjAD", ",", "trueadjA"}], "]"}]}], "numberOfLinks"]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GeneratePPC", "[", 
    RowBox[{"adjA_", ",", "trueadjA_", ",", 
     RowBox[{"stepsize_:", "10"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"d", "=", 
        RowBox[{"Length", "@", "adjA"}]}], ",", "adjAD"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{
           RowBox[{"adjAD", "=", 
            RowBox[{"ThresholdedNumberA", "[", 
             RowBox[{"adjA", ",", "n"}], "]"}]}], ";", 
           RowBox[{"N", "@", 
            RowBox[{"PPCpoint", "[", 
             RowBox[{"adjAD", ",", "trueadjA", ",", "n"}], "]"}]}]}]}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", 
          RowBox[{"d", "*", 
           RowBox[{"(", 
            RowBox[{"d", "-", "1"}], ")"}]}], ",", "stepsize"}], "}"}]}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.54107736225871*^9, 3.541077458004822*^9}, {
   3.5410777745856743`*^9, 3.541077822049362*^9}, {3.541077853157542*^9, 
   3.541077857294984*^9}, {3.541077970522251*^9, 3.541077970586261*^9}, 
   3.541078044094548*^9, {3.541078092186698*^9, 3.541078148519009*^9}, {
   3.541078848268813*^9, 3.541078887811013*^9}, {3.541079246420402*^9, 
   3.541079247184155*^9}, {3.541079299729369*^9, 3.541079352060933*^9}, {
   3.541079435214877*^9, 3.541079435283956*^9}, {3.5410807676246967`*^9, 
   3.54108076772847*^9}, {3.5410809800174227`*^9, 3.541080991974543*^9}, {
   3.542426628894185*^9, 3.542426629432975*^9}, {3.543565916163574*^9, 
   3.543566009451716*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
examine reconstruction quality for a given conditioning level\
\>", "Section",
 CellChangeTimes->{{3.5154989641155376`*^9, 3.515499014475491*^9}, {
  3.515499492398241*^9, 3.515499504883956*^9}, {3.5771635163417587`*^9, 
  3.577163525627005*^9}}],

Cell[CellGroupData[{

Cell["set up parameters", "Subsubsection",
 CellChangeTimes->{{3.576991805333727*^9, 3.576991812061343*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "SetDirectory", "[", "\"\<~/Desktop/Doktorarbeit/Causality/challenge\>\"", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"adjAdir", " ", "=", " ", "\"\<topologies\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"networkSizes", "=", 
   RowBox[{"{", 
    RowBox[{"50", ",", "100", ",", "500"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topoIndices", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0.1", ",", "0.6", ",", "0.1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iNet", "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.474634702299938*^9, 3.4746347311544733`*^9}, {
   3.474718670119697*^9, 3.474718671924358*^9}, {3.4747971416678543`*^9, 
   3.474797142475212*^9}, {3.474800489261229*^9, 3.474800489995036*^9}, {
   3.4760844313613997`*^9, 3.476084449688715*^9}, {3.477647614937677*^9, 
   3.4776476200637407`*^9}, {3.477723656894039*^9, 3.477723660341339*^9}, 
   3.4777236916143436`*^9, {3.47843120995232*^9, 3.478431210373921*^9}, {
   3.479111919522838*^9, 3.479111920824479*^9}, {3.479644264887505*^9, 
   3.479644271366432*^9}, {3.480670259483221*^9, 3.480670260083139*^9}, {
   3.480671532791873*^9, 3.4806715353508*^9}, {3.480676420327409*^9, 
   3.480676420953883*^9}, {3.480760456996578*^9, 3.480760457293254*^9}, {
   3.4825188377099543`*^9, 3.482518840498953*^9}, {3.4833794056867733`*^9, 
   3.4833794067172947`*^9}, 3.484301583415799*^9, {3.490769208364706*^9, 
   3.4907692126014643`*^9}, {3.4907692882945766`*^9, 3.490769300156436*^9}, 
   3.4907701687486753`*^9, {3.490772088619722*^9, 3.490772089233971*^9}, {
   3.490776650233671*^9, 3.490776651295806*^9}, {3.491225486663361*^9, 
   3.491225487013069*^9}, {3.491226178110815*^9, 3.491226178731525*^9}, {
   3.491228898620735*^9, 3.491228902367524*^9}, {3.491230405401663*^9, 
   3.491230405960066*^9}, {3.49123775104733*^9, 3.491237752924334*^9}, {
   3.491240472039193*^9, 3.4912404732538853`*^9}, {3.491624902491818*^9, 
   3.491624903161685*^9}, {3.491627612018119*^9, 3.491627612610009*^9}, {
   3.4928683498104343`*^9, 3.492868350246583*^9}, {3.492891215236514*^9, 
   3.4928912164247723`*^9}, {3.496753430751967*^9, 3.496753432061798*^9}, {
   3.4967553273278017`*^9, 3.496755328033649*^9}, {3.497072519593206*^9, 
   3.497072525854022*^9}, {3.497074859240981*^9, 3.497074860038789*^9}, {
   3.497677360021574*^9, 3.497677361011258*^9}, 3.500124228960513*^9, {
   3.500124260664947*^9, 3.500124261448269*^9}, {3.503667210225281*^9, 
   3.503667213998219*^9}, {3.503668184823779*^9, 3.503668185414122*^9}, {
   3.503668464978655*^9, 3.5036684676419783`*^9}, {3.5036687074386883`*^9, 
   3.503668708004808*^9}, {3.5058926062125673`*^9, 3.505892611722001*^9}, 
   3.505892678987118*^9, {3.50589272454012*^9, 3.5058927251257963`*^9}, {
   3.505901171757123*^9, 3.505901172690816*^9}, 3.5086535921193447`*^9, {
   3.513163478215461*^9, 3.513163480068555*^9}, {3.5131651614104443`*^9, 
   3.513165162066825*^9}, {3.514191419922139*^9, 3.5141914269406147`*^9}, {
   3.514261189710806*^9, 3.5142612160779*^9}, {3.514261296339814*^9, 
   3.514261297185761*^9}, {3.514275586284886*^9, 3.5142755879544563`*^9}, {
   3.514278303686322*^9, 3.5142783051008997`*^9}, {3.5143656990600367`*^9, 
   3.51436570063405*^9}, {3.514373497790188*^9, 3.514373499732218*^9}, {
   3.514379819523666*^9, 3.514379820362249*^9}, {3.5143801438552027`*^9, 
   3.514380146693182*^9}, 3.514634280124322*^9, {3.514638012636098*^9, 
   3.514638013830743*^9}, {3.514799180130265*^9, 3.514799181258954*^9}, {
   3.514799273445478*^9, 3.514799274084939*^9}, {3.514962289908408*^9, 
   3.514962293521626*^9}, {3.5149626042841597`*^9, 3.5149626089701967`*^9}, {
   3.51496337375905*^9, 3.514963409226211*^9}, {3.514963507599246*^9, 
   3.514963515792264*^9}, {3.51496359042733*^9, 3.5149635909531717`*^9}, {
   3.515146013935244*^9, 3.5151460376288967`*^9}, {3.5151461012599783`*^9, 
   3.5151461015878572`*^9}, {3.515146372850395*^9, 3.5151463736019487`*^9}, {
   3.515147283010332*^9, 3.515147283078937*^9}, {3.515147473884351*^9, 
   3.515147474194284*^9}, {3.515147798173431*^9, 3.515147799429008*^9}, {
   3.5151516349967318`*^9, 3.5151516352826767`*^9}, {3.51515182612817*^9, 
   3.5151518272061253`*^9}, {3.515151921928471*^9, 3.5151519221040173`*^9}, {
   3.5151519527908583`*^9, 3.515151952876807*^9}, {3.515214605533608*^9, 
   3.515214619075626*^9}, {3.515214711266753*^9, 3.5152147446159*^9}, {
   3.515214873428187*^9, 3.5152148739800034`*^9}, {3.515214904653006*^9, 
   3.5152149055312643`*^9}, {3.5152150290956373`*^9, 3.515215032807062*^9}, {
   3.515215081807581*^9, 3.515215081885435*^9}, {3.515228091543935*^9, 
   3.51522809353552*^9}, {3.5152421202308893`*^9, 3.515242120325194*^9}, {
   3.515242252714672*^9, 3.515242257536331*^9}, {3.515242361460606*^9, 
   3.515242361541031*^9}, {3.515242670941564*^9, 3.515242700386055*^9}, {
   3.515242737681757*^9, 3.515242737746748*^9}, {3.5153057216960163`*^9, 
   3.515305730850519*^9}, {3.5153059369596987`*^9, 3.5153059372311773`*^9}, {
   3.51530646972163*^9, 3.515306475576795*^9}, 3.5153074518796883`*^9, {
   3.515307748127615*^9, 3.5153077555256863`*^9}, {3.515307957563592*^9, 
   3.5153079577134323`*^9}, {3.5153082191802387`*^9, 3.515308231049602*^9}, {
   3.5153085221929626`*^9, 3.5153085223365593`*^9}, {3.515308808124158*^9, 
   3.515308815598482*^9}, {3.5153090481878347`*^9, 3.515309048255547*^9}, {
   3.5153093409317636`*^9, 3.515309340986574*^9}, {3.5153096551038313`*^9, 
   3.515309660501729*^9}, {3.515310239973464*^9, 3.515310240065832*^9}, {
   3.515310582825555*^9, 3.515310582903373*^9}, {3.51533060987132*^9, 
   3.515330629471306*^9}, {3.515330807537339*^9, 3.515330807801035*^9}, {
   3.515337435184613*^9, 3.5153374353104773`*^9}, {3.515391381992544*^9, 
   3.5153913821887817`*^9}, {3.515394908925256*^9, 3.515394909051375*^9}, {
   3.5154034720037117`*^9, 3.515403472217854*^9}, {3.515403521277824*^9, 
   3.515403521405982*^9}, {3.515499530075738*^9, 3.515499603706376*^9}, {
   3.515500206738936*^9, 3.515500207689917*^9}, 3.5155005281708*^9, {
   3.515502753313036*^9, 3.515502753447475*^9}, {3.515674223359654*^9, 
   3.515674223584272*^9}, {3.515676372800804*^9, 3.515676372936878*^9}, {
   3.515752942537463*^9, 3.5157529427423773`*^9}, {3.515754216685384*^9, 
   3.515754216835277*^9}, {3.515820490925688*^9, 3.515820491111033*^9}, {
   3.5158205934151783`*^9, 3.5158205938226748`*^9}, {3.515820634912677*^9, 
   3.515820635054216*^9}, {3.515823438592895*^9, 3.515823438807004*^9}, {
   3.51601663614327*^9, 3.516016636287363*^9}, {3.516022231350192*^9, 
   3.516022231565063*^9}, {3.5160224938785343`*^9, 3.516022494011141*^9}, {
   3.5249808893907557`*^9, 3.5249809021140633`*^9}, {3.524981052987*^9, 
   3.524981063568552*^9}, {3.524981117149889*^9, 3.5249811199958277`*^9}, {
   3.524981651274012*^9, 3.524981653280642*^9}, {3.5249821769112587`*^9, 
   3.524982177039063*^9}, {3.524989029981166*^9, 3.524989033707501*^9}, {
   3.524989087488296*^9, 3.524989089343855*^9}, {3.5249918057891693`*^9, 
   3.524991810736558*^9}, {3.524998019827677*^9, 3.524998020048999*^9}, {
   3.5251680004250107`*^9, 3.525168004308421*^9}, {3.5254274332630243`*^9, 
   3.525427442221191*^9}, {3.52542833604869*^9, 3.525428336791173*^9}, {
   3.525429272184601*^9, 3.525429272293198*^9}, {3.5260204847004004`*^9, 
   3.526020505126781*^9}, {3.526020591385762*^9, 3.5260205917110443`*^9}, {
   3.526020792112996*^9, 3.5260207922232313`*^9}, {3.526038913571953*^9, 
   3.526038913746687*^9}, {3.526039127196721*^9, 3.526039183647052*^9}, {
   3.527839827987936*^9, 3.5278398459730864`*^9}, {3.527841537531845*^9, 
   3.527841541644251*^9}, {3.528016728825432*^9, 3.528016731423966*^9}, {
   3.528018417883114*^9, 3.528018418001712*^9}, 3.528033421721218*^9, {
   3.5280450832403107`*^9, 3.528045088319909*^9}, {3.528099976510997*^9, 
   3.5280999805106363`*^9}, {3.528100873107737*^9, 3.52810088530761*^9}, {
   3.528115314414332*^9, 3.528115349211403*^9}, {3.528185567371114*^9, 
   3.528185567577344*^9}, {3.5282618312410927`*^9, 3.5282618313989*^9}, {
   3.528263988442212*^9, 3.5282639886489162`*^9}, {3.5284312691306973`*^9, 
   3.5284312692637978`*^9}, {3.529154516010826*^9, 3.529154593108193*^9}, {
   3.529155054144273*^9, 3.529155054241406*^9}, {3.5297318111720543`*^9, 
   3.529731827017363*^9}, {3.529741029400405*^9, 3.529741044599402*^9}, {
   3.576991466681662*^9, 3.576991558013529*^9}, {3.576991597975078*^9, 
   3.5769916004617777`*^9}, {3.576991729957385*^9, 3.576991732793254*^9}, {
   3.576992112897375*^9, 3.5769921232660093`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tuples", "[", 
  RowBox[{"{", 
   RowBox[{"networkSizes", ",", "topoIndices"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.576991734689687*^9, 3.5769917948884974`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"50", ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"50", ",", "0.2`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"50", ",", "0.30000000000000004`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"50", ",", "0.4`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"50", ",", "0.5`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"50", ",", "0.6`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"100", ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"100", ",", "0.2`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"100", ",", "0.30000000000000004`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"100", ",", "0.4`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"100", ",", "0.5`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"100", ",", "0.6`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"500", ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"500", ",", "0.2`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"500", ",", "0.30000000000000004`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"500", ",", "0.4`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"500", ",", "0.5`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"500", ",", "0.6`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.576991763070713*^9, 3.576991795203107*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["load ground truth matrices", "Subsubsection",
 CellChangeTimes->{{3.576991814973724*^9, 3.5769918224811363`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"trueadjAs", "=", 
   RowBox[{"trueposlists", "=", 
    RowBox[{"{", "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s", ",", "cc"}], "}"}], "=", "topology"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"filename", "=", 
      RowBox[{"adjAdir", "<>", "\"\</topology_iNet\>\"", "<>", 
       RowBox[{"ToString", "[", "iNet", "]"}], "<>", "\"\<_Size\>\"", "<>", 
       RowBox[{"ToString", "[", "s", "]"}], "<>", "\"\<_CC0\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"Round", "[", 
         RowBox[{"10", " ", "cc"}], "]"}], "]"}], "<>", "\"\<.yaml\>\""}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Print", "@", "filename"}], ";"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "filename", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<importing \>\"", ",", "filename", ",", "\"\< ...\>\""}],
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"trueadjAs", ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "cc", ",", 
            RowBox[{"First", "[", 
             RowBox[{"ximport", "=", 
              RowBox[{"ImportNetworkFromYAML", "[", "filename", "]"}]}], 
             "]"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"trueposlists", ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "cc", ",", 
            RowBox[{"Second", "@", "ximport"}]}], "}"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<YAML matrix input file \>\"", ",", "filename", ",", 
          "\"\< not found!\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"topology", ",", 
      RowBox[{"Tuples", "[", 
       RowBox[{"{", 
        RowBox[{"networkSizes", ",", "topoIndices"}], "}"}], "]"}]}], "}"}]}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<done.\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"s", ",", "cc", ",", "filename", ",", "ximport"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.576991829180478*^9, 3.5769920944328623`*^9}, {
  3.576992291306225*^9, 3.576992353434657*^9}, {3.576992391224682*^9, 
  3.5769925163405657`*^9}, {3.576992654810092*^9, 3.5769926557451363`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
evaluate quality of reconstructions\
\>", "Subsubsection",
 CellChangeTimes->{{3.57699253072605*^9, 3.57699254525203*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ROCs", "=", 
   RowBox[{"TP10percents", "=", 
    RowBox[{"{", "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"recFiles", "=", 
   RowBox[{"Sort", "@", 
    RowBox[{"FileNames", "[", "\"\<reconstructions/adjA*.mx\>\"", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"parsFiles", "=", 
    RowBox[{"Sort", "@", 
     RowBox[{"FileNames", "[", "\"\<reconstructions/pars*.mx\>\"", "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"recFileName", ",", "parsFileName"}], "}"}], "=", "fff"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"pars", "=", 
      RowBox[{"Get", "[", "parsFileName", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"s", "=", 
      RowBox[{
       RowBox[{"Symbol", "[", "\"\<size\>\"", "]"}], "/.", "pars"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"the", " ", "following", " ", "assumes", " ", "a", " ", 
         RowBox[{"fluoro", ".", " ", "file"}], " ", "name", " ", "format", 
         " ", "ending", " ", "in"}], " ", "..."}], 
       RowBox[{"_CC01", ".", "txt"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"cc", "=", 
      RowBox[{"0.1", "*", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Symbol", "[", "\"\<inputfile\>\"", "]"}], "/.", "pars"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"-", "5"}], "}"}]}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<analyzing \>\"", ",", "recFileName", ",", "\"\< (s = \>\"", ",", 
       "s", ",", "\"\<, cc = \>\"", ",", "cc", ",", "\"\<) ...\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"trueadjA", "=", 
      RowBox[{"Last", "@", 
       RowBox[{"First", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"trueadjAs", ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "cc", ",", "__"}], "}"}]}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"xadjA", "=", 
      RowBox[{"Get", "[", "recFileName", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"take", " ", "lowest", " ", "global", " ", "bin"}], ",", " ", 
       RowBox[{
       "if", " ", "more", " ", "than", " ", "one", " ", "is", " ", 
        "available"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", 
         RowBox[{"Dimensions", "@", "xadjA"}]}], ">", "2"}], ",", 
       RowBox[{"xadjA", "=", 
        RowBox[{"xadjA", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}]}]}],
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"ROCs", ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "cc", ",", 
         RowBox[{"GenerateROCsmart", "[", 
          RowBox[{"xadjA", ",", "trueadjA"}], "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"TP10percents", ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "cc", ",", 
         RowBox[{"xtp", "=", 
          RowBox[{"TPat10FP", "[", 
           RowBox[{"xadjA", ",", "trueadjA"}], "]"}]}]}], "}"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<-> found TP@10%FP performance of \>\"", ",", "xtp"}], 
      "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"fff", ",", 
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"recFiles", ",", "parsFiles"}], "}"}]}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "pars", ",", "s", ",", "cc", ",", "trueadjA", ",", "xadjA", ",", "xtp"}], 
   "]"}], ";"}], "\[IndentingNewLine]", "TP10percents"}], "Input",
 CellChangeTimes->{{3.576992573702709*^9, 3.576993078200306*^9}, {
   3.576993194877028*^9, 3.576993208798905*^9}, {3.576993245766613*^9, 
   3.576993269500984*^9}, {3.577001497824472*^9, 3.577001581429282*^9}, 
   3.577001643195665*^9, {3.5770016924454193`*^9, 3.577001694373336*^9}, {
   3.577001726223508*^9, 3.577001962789134*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
examine reconstruction quality when scanning conditioning levels\
\>", "Section",
 CellChangeTimes->{{3.5154989641155376`*^9, 3.515499014475491*^9}, {
  3.515499492398241*^9, 3.515499504883956*^9}, {3.5771635163417587`*^9, 
  3.577163546522477*^9}}],

Cell[CellGroupData[{

Cell["set up parameters", "Subsubsection",
 CellChangeTimes->{{3.576991805333727*^9, 3.576991812061343*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "SetDirectory", "[", "\"\<~/Desktop/Doktorarbeit/Causality/challenge\>\"", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"adjAdir", " ", "=", " ", "\"\<topologies\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"networkSizes", "=", 
   RowBox[{"{", 
    RowBox[{"50", ",", "100", ",", "500"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topoIndices", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0.1", ",", "0.6", ",", "0.1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iNet", "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.474634702299938*^9, 3.4746347311544733`*^9}, {
   3.474718670119697*^9, 3.474718671924358*^9}, {3.4747971416678543`*^9, 
   3.474797142475212*^9}, {3.474800489261229*^9, 3.474800489995036*^9}, {
   3.4760844313613997`*^9, 3.476084449688715*^9}, {3.477647614937677*^9, 
   3.4776476200637407`*^9}, {3.477723656894039*^9, 3.477723660341339*^9}, 
   3.4777236916143436`*^9, {3.47843120995232*^9, 3.478431210373921*^9}, {
   3.479111919522838*^9, 3.479111920824479*^9}, {3.479644264887505*^9, 
   3.479644271366432*^9}, {3.480670259483221*^9, 3.480670260083139*^9}, {
   3.480671532791873*^9, 3.4806715353508*^9}, {3.480676420327409*^9, 
   3.480676420953883*^9}, {3.480760456996578*^9, 3.480760457293254*^9}, {
   3.4825188377099543`*^9, 3.482518840498953*^9}, {3.4833794056867733`*^9, 
   3.4833794067172947`*^9}, 3.484301583415799*^9, {3.490769208364706*^9, 
   3.4907692126014643`*^9}, {3.4907692882945766`*^9, 3.490769300156436*^9}, 
   3.4907701687486753`*^9, {3.490772088619722*^9, 3.490772089233971*^9}, {
   3.490776650233671*^9, 3.490776651295806*^9}, {3.491225486663361*^9, 
   3.491225487013069*^9}, {3.491226178110815*^9, 3.491226178731525*^9}, {
   3.491228898620735*^9, 3.491228902367524*^9}, {3.491230405401663*^9, 
   3.491230405960066*^9}, {3.49123775104733*^9, 3.491237752924334*^9}, {
   3.491240472039193*^9, 3.4912404732538853`*^9}, {3.491624902491818*^9, 
   3.491624903161685*^9}, {3.491627612018119*^9, 3.491627612610009*^9}, {
   3.4928683498104343`*^9, 3.492868350246583*^9}, {3.492891215236514*^9, 
   3.4928912164247723`*^9}, {3.496753430751967*^9, 3.496753432061798*^9}, {
   3.4967553273278017`*^9, 3.496755328033649*^9}, {3.497072519593206*^9, 
   3.497072525854022*^9}, {3.497074859240981*^9, 3.497074860038789*^9}, {
   3.497677360021574*^9, 3.497677361011258*^9}, 3.500124228960513*^9, {
   3.500124260664947*^9, 3.500124261448269*^9}, {3.503667210225281*^9, 
   3.503667213998219*^9}, {3.503668184823779*^9, 3.503668185414122*^9}, {
   3.503668464978655*^9, 3.5036684676419783`*^9}, {3.5036687074386883`*^9, 
   3.503668708004808*^9}, {3.5058926062125673`*^9, 3.505892611722001*^9}, 
   3.505892678987118*^9, {3.50589272454012*^9, 3.5058927251257963`*^9}, {
   3.505901171757123*^9, 3.505901172690816*^9}, 3.5086535921193447`*^9, {
   3.513163478215461*^9, 3.513163480068555*^9}, {3.5131651614104443`*^9, 
   3.513165162066825*^9}, {3.514191419922139*^9, 3.5141914269406147`*^9}, {
   3.514261189710806*^9, 3.5142612160779*^9}, {3.514261296339814*^9, 
   3.514261297185761*^9}, {3.514275586284886*^9, 3.5142755879544563`*^9}, {
   3.514278303686322*^9, 3.5142783051008997`*^9}, {3.5143656990600367`*^9, 
   3.51436570063405*^9}, {3.514373497790188*^9, 3.514373499732218*^9}, {
   3.514379819523666*^9, 3.514379820362249*^9}, {3.5143801438552027`*^9, 
   3.514380146693182*^9}, 3.514634280124322*^9, {3.514638012636098*^9, 
   3.514638013830743*^9}, {3.514799180130265*^9, 3.514799181258954*^9}, {
   3.514799273445478*^9, 3.514799274084939*^9}, {3.514962289908408*^9, 
   3.514962293521626*^9}, {3.5149626042841597`*^9, 3.5149626089701967`*^9}, {
   3.51496337375905*^9, 3.514963409226211*^9}, {3.514963507599246*^9, 
   3.514963515792264*^9}, {3.51496359042733*^9, 3.5149635909531717`*^9}, {
   3.515146013935244*^9, 3.5151460376288967`*^9}, {3.5151461012599783`*^9, 
   3.5151461015878572`*^9}, {3.515146372850395*^9, 3.5151463736019487`*^9}, {
   3.515147283010332*^9, 3.515147283078937*^9}, {3.515147473884351*^9, 
   3.515147474194284*^9}, {3.515147798173431*^9, 3.515147799429008*^9}, {
   3.5151516349967318`*^9, 3.5151516352826767`*^9}, {3.51515182612817*^9, 
   3.5151518272061253`*^9}, {3.515151921928471*^9, 3.5151519221040173`*^9}, {
   3.5151519527908583`*^9, 3.515151952876807*^9}, {3.515214605533608*^9, 
   3.515214619075626*^9}, {3.515214711266753*^9, 3.5152147446159*^9}, {
   3.515214873428187*^9, 3.5152148739800034`*^9}, {3.515214904653006*^9, 
   3.5152149055312643`*^9}, {3.5152150290956373`*^9, 3.515215032807062*^9}, {
   3.515215081807581*^9, 3.515215081885435*^9}, {3.515228091543935*^9, 
   3.51522809353552*^9}, {3.5152421202308893`*^9, 3.515242120325194*^9}, {
   3.515242252714672*^9, 3.515242257536331*^9}, {3.515242361460606*^9, 
   3.515242361541031*^9}, {3.515242670941564*^9, 3.515242700386055*^9}, {
   3.515242737681757*^9, 3.515242737746748*^9}, {3.5153057216960163`*^9, 
   3.515305730850519*^9}, {3.5153059369596987`*^9, 3.5153059372311773`*^9}, {
   3.51530646972163*^9, 3.515306475576795*^9}, 3.5153074518796883`*^9, {
   3.515307748127615*^9, 3.5153077555256863`*^9}, {3.515307957563592*^9, 
   3.5153079577134323`*^9}, {3.5153082191802387`*^9, 3.515308231049602*^9}, {
   3.5153085221929626`*^9, 3.5153085223365593`*^9}, {3.515308808124158*^9, 
   3.515308815598482*^9}, {3.5153090481878347`*^9, 3.515309048255547*^9}, {
   3.5153093409317636`*^9, 3.515309340986574*^9}, {3.5153096551038313`*^9, 
   3.515309660501729*^9}, {3.515310239973464*^9, 3.515310240065832*^9}, {
   3.515310582825555*^9, 3.515310582903373*^9}, {3.51533060987132*^9, 
   3.515330629471306*^9}, {3.515330807537339*^9, 3.515330807801035*^9}, {
   3.515337435184613*^9, 3.5153374353104773`*^9}, {3.515391381992544*^9, 
   3.5153913821887817`*^9}, {3.515394908925256*^9, 3.515394909051375*^9}, {
   3.5154034720037117`*^9, 3.515403472217854*^9}, {3.515403521277824*^9, 
   3.515403521405982*^9}, {3.515499530075738*^9, 3.515499603706376*^9}, {
   3.515500206738936*^9, 3.515500207689917*^9}, 3.5155005281708*^9, {
   3.515502753313036*^9, 3.515502753447475*^9}, {3.515674223359654*^9, 
   3.515674223584272*^9}, {3.515676372800804*^9, 3.515676372936878*^9}, {
   3.515752942537463*^9, 3.5157529427423773`*^9}, {3.515754216685384*^9, 
   3.515754216835277*^9}, {3.515820490925688*^9, 3.515820491111033*^9}, {
   3.5158205934151783`*^9, 3.5158205938226748`*^9}, {3.515820634912677*^9, 
   3.515820635054216*^9}, {3.515823438592895*^9, 3.515823438807004*^9}, {
   3.51601663614327*^9, 3.516016636287363*^9}, {3.516022231350192*^9, 
   3.516022231565063*^9}, {3.5160224938785343`*^9, 3.516022494011141*^9}, {
   3.5249808893907557`*^9, 3.5249809021140633`*^9}, {3.524981052987*^9, 
   3.524981063568552*^9}, {3.524981117149889*^9, 3.5249811199958277`*^9}, {
   3.524981651274012*^9, 3.524981653280642*^9}, {3.5249821769112587`*^9, 
   3.524982177039063*^9}, {3.524989029981166*^9, 3.524989033707501*^9}, {
   3.524989087488296*^9, 3.524989089343855*^9}, {3.5249918057891693`*^9, 
   3.524991810736558*^9}, {3.524998019827677*^9, 3.524998020048999*^9}, {
   3.5251680004250107`*^9, 3.525168004308421*^9}, {3.5254274332630243`*^9, 
   3.525427442221191*^9}, {3.52542833604869*^9, 3.525428336791173*^9}, {
   3.525429272184601*^9, 3.525429272293198*^9}, {3.5260204847004004`*^9, 
   3.526020505126781*^9}, {3.526020591385762*^9, 3.5260205917110443`*^9}, {
   3.526020792112996*^9, 3.5260207922232313`*^9}, {3.526038913571953*^9, 
   3.526038913746687*^9}, {3.526039127196721*^9, 3.526039183647052*^9}, {
   3.527839827987936*^9, 3.5278398459730864`*^9}, {3.527841537531845*^9, 
   3.527841541644251*^9}, {3.528016728825432*^9, 3.528016731423966*^9}, {
   3.528018417883114*^9, 3.528018418001712*^9}, 3.528033421721218*^9, {
   3.5280450832403107`*^9, 3.528045088319909*^9}, {3.528099976510997*^9, 
   3.5280999805106363`*^9}, {3.528100873107737*^9, 3.52810088530761*^9}, {
   3.528115314414332*^9, 3.528115349211403*^9}, {3.528185567371114*^9, 
   3.528185567577344*^9}, {3.5282618312410927`*^9, 3.5282618313989*^9}, {
   3.528263988442212*^9, 3.5282639886489162`*^9}, {3.5284312691306973`*^9, 
   3.5284312692637978`*^9}, {3.529154516010826*^9, 3.529154593108193*^9}, {
   3.529155054144273*^9, 3.529155054241406*^9}, {3.5297318111720543`*^9, 
   3.529731827017363*^9}, {3.529741029400405*^9, 3.529741044599402*^9}, {
   3.576991466681662*^9, 3.576991558013529*^9}, {3.576991597975078*^9, 
   3.5769916004617777`*^9}, {3.576991729957385*^9, 3.576991732793254*^9}, {
   3.576992112897375*^9, 3.5769921232660093`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["load ground truth matrices", "Subsubsection",
 CellChangeTimes->{{3.576991814973724*^9, 3.5769918224811363`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"trueadjAs", "=", 
   RowBox[{"trueposlists", "=", 
    RowBox[{"{", "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s", ",", "cc"}], "}"}], "=", "topology"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"filename", "=", 
      RowBox[{"adjAdir", "<>", "\"\</topology_iNet\>\"", "<>", 
       RowBox[{"ToString", "[", "iNet", "]"}], "<>", "\"\<_Size\>\"", "<>", 
       RowBox[{"ToString", "[", "s", "]"}], "<>", "\"\<_CC0\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"Round", "[", 
         RowBox[{"10", " ", "cc"}], "]"}], "]"}], "<>", "\"\<.yaml\>\""}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Print", "@", "filename"}], ";"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "filename", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<importing \>\"", ",", "filename", ",", "\"\< ...\>\""}],
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"trueadjAs", ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "cc", ",", 
            RowBox[{"First", "[", 
             RowBox[{"ximport", "=", 
              RowBox[{"ImportNetworkFromYAML", "[", "filename", "]"}]}], 
             "]"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"trueposlists", ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "cc", ",", 
            RowBox[{"Second", "@", "ximport"}]}], "}"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<YAML matrix input file \>\"", ",", "filename", ",", 
          "\"\< not found!\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"topology", ",", 
      RowBox[{"Tuples", "[", 
       RowBox[{"{", 
        RowBox[{"networkSizes", ",", "topoIndices"}], "}"}], "]"}]}], "}"}]}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<done.\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"s", ",", "cc", ",", "filename", ",", "ximport"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.576991829180478*^9, 3.5769920944328623`*^9}, {
  3.576992291306225*^9, 3.576992353434657*^9}, {3.576992391224682*^9, 
  3.5769925163405657`*^9}, {3.576992654810092*^9, 3.5769926557451363`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
evaluate quality of reconstructions (if all files present)\
\>", "Subsubsection",
 CellChangeTimes->{{3.57699253072605*^9, 3.57699254525203*^9}, {
  3.584251861665173*^9, 3.58425186687284*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TP10percents", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"recFiles", "=", 
   RowBox[{"Sort", "@", 
    RowBox[{"FileNames", "[", "\"\<reconstructions/adjA*.mx\>\"", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"parsFiles", "=", 
    RowBox[{"Sort", "@", 
     RowBox[{"FileNames", "[", "\"\<reconstructions/pars*.mx\>\"", "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"recFileName", ",", "parsFileName"}], "}"}], "=", "fff"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"pars", "=", 
      RowBox[{"Get", "[", "parsFileName", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"s", "=", 
      RowBox[{
       RowBox[{"Symbol", "[", "\"\<size\>\"", "]"}], "/.", "pars"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"the", " ", "following", " ", "assumes", " ", "a", " ", 
         RowBox[{"fluoro", ".", " ", "file"}], " ", "name", " ", "format", 
         " ", "ending", " ", "in"}], " ", "..."}], 
       RowBox[{"_CC01", ".", "txt"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"cc", "=", 
      RowBox[{"0.1", "*", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Symbol", "[", "\"\<inputfile\>\"", "]"}], "/.", "pars"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"-", "5"}], "}"}]}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cond", "=", 
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{"Symbol", "[", "\"\<GlobalConditioningLevel\>\"", "]"}], "/.",
         "pars"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<analyzing \>\"", ",", "recFileName", ",", "\"\< (s = \>\"", ",", 
       "s", ",", "\"\<, cc = \>\"", ",", "cc", ",", "\"\<, cond = \>\"", ",", 
       "cond", ",", "\"\<) ...\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"trueadjA", "=", 
      RowBox[{"Last", "@", 
       RowBox[{"First", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"trueadjAs", ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "cc", ",", "__"}], "}"}]}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"xadjA", "=", 
      RowBox[{"Get", "[", "recFileName", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"take", " ", "lowest", " ", "global", " ", "bin"}], ",", " ", 
       RowBox[{
       "if", " ", "more", " ", "than", " ", "one", " ", "is", " ", 
        "available"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", 
         RowBox[{"Dimensions", "@", "xadjA"}]}], ">", "2"}], ",", 
       RowBox[{"xadjA", "=", 
        RowBox[{"xadjA", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}]}]}],
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"ROCs", ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "cc", ",", "cond", ",", 
           RowBox[{"GenerateROCsmart", "[", 
            RowBox[{"xadjA", ",", "trueadjA"}], "]"}]}], "}"}]}], "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"TP10percents", ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "cc", ",", "cond", ",", 
         RowBox[{"xtp", "=", 
          RowBox[{"TPat10FP", "[", 
           RowBox[{"xadjA", ",", "trueadjA"}], "]"}]}]}], "}"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<-> found TP@10%FP performance of \>\"", ",", "xtp"}], 
      "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"fff", ",", 
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"recFiles", ",", "parsFiles"}], "}"}]}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "pars", ",", "s", ",", "cc", ",", "cond", ",", "trueadjA", ",", "xadjA", 
    ",", "xtp"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.576992573702709*^9, 3.576993078200306*^9}, {
   3.576993194877028*^9, 3.576993208798905*^9}, {3.576993245766613*^9, 
   3.576993269500984*^9}, {3.577001497824472*^9, 3.577001581429282*^9}, 
   3.577001643195665*^9, {3.5770016924454193`*^9, 3.577001694373336*^9}, {
   3.577001726223508*^9, 3.577001962789134*^9}, {3.577163587646381*^9, 
   3.5771636811866093`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
evaluate quality of reconstructions (if not all files present)\
\>", "Subsubsection",
 CellChangeTimes->{{3.57699253072605*^9, 3.57699254525203*^9}, {
  3.584251861665173*^9, 3.584251879297461*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TP10percents", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"recFiles", "=", 
    RowBox[{"Sort", "@", 
     RowBox[{"FileNames", "[", "\"\<reconstructions/adjA*.mx\>\"", "]"}]}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"parsFiles", "=", 
     RowBox[{"Sort", "@", 
      RowBox[{"FileNames", "[", "\"\<reconstructions/pars*.mx\>\"", "]"}]}]}],
     ";"}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"recFileName", ",", "parsFileName"}], "}"}], "=", "fff"}], 
     ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fileIndex", "=", 
      RowBox[{"ToExpression", "@", 
       RowBox[{"StringTrim", "[", 
        RowBox[{"recFileName", ",", 
         RowBox[{
          RowBox[{"Except", "[", "DigitCharacter", "]"}], "..."}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pars", "=", 
      RowBox[{"Get", "[", 
       RowBox[{"\"\<reconstructions/pars_iteration\>\"", "<>", 
        RowBox[{"ToString", "[", "fileIndex", "]"}], "<>", "\"\<.mx\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"s", "=", 
      RowBox[{
       RowBox[{"Symbol", "[", "\"\<size\>\"", "]"}], "/.", "pars"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"the", " ", "following", " ", "assumes", " ", "a", " ", 
         RowBox[{"fluoro", ".", " ", "file"}], " ", "name", " ", "format", 
         " ", "ending", " ", "in"}], " ", "..."}], 
       RowBox[{"_CC01", ".", "txt"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"cc", "=", 
      RowBox[{"0.1", "*", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Symbol", "[", "\"\<inputfile\>\"", "]"}], "/.", "pars"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"-", "5"}], "}"}]}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cond", "=", 
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{"Symbol", "[", "\"\<GlobalConditioningLevel\>\"", "]"}], "/.",
         "pars"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<analyzing \>\"", ",", "recFileName", ",", "\"\< (s = \>\"", ",", 
       "s", ",", "\"\<, cc = \>\"", ",", "cc", ",", "\"\<, cond = \>\"", ",", 
       "cond", ",", "\"\<) ...\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"trueadjA", "=", 
      RowBox[{"Last", "@", 
       RowBox[{"First", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"trueadjAs", ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "cc", ",", "__"}], "}"}]}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"xadjA", "=", 
      RowBox[{"Get", "[", "recFileName", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"take", " ", "lowest", " ", "global", " ", "bin"}], ",", " ", 
       RowBox[{
       "if", " ", "more", " ", "than", " ", "one", " ", "is", " ", 
        "available"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", 
         RowBox[{"Dimensions", "@", "xadjA"}]}], ">", "2"}], ",", 
       RowBox[{"xadjA", "=", 
        RowBox[{"xadjA", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}]}]}],
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"ROCs", ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "cc", ",", "cond", ",", 
           RowBox[{"GenerateROCsmart", "[", 
            RowBox[{"xadjA", ",", "trueadjA"}], "]"}]}], "}"}]}], "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"TP10percents", ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "cc", ",", "cond", ",", 
         RowBox[{"xtp", "=", 
          RowBox[{"TPat10FP", "[", 
           RowBox[{"xadjA", ",", "trueadjA"}], "]"}]}]}], "}"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<-> found TP@10%FP performance of \>\"", ",", "xtp"}], 
      "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"recFileName", ",", "recFiles"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "fileIndex", ",", "pars", ",", "s", ",", "cc", ",", "cond", ",", 
    "trueadjA", ",", "xadjA", ",", "xtp"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.576992573702709*^9, 3.576993078200306*^9}, {
   3.576993194877028*^9, 3.576993208798905*^9}, {3.576993245766613*^9, 
   3.576993269500984*^9}, {3.577001497824472*^9, 3.577001581429282*^9}, 
   3.577001643195665*^9, {3.5770016924454193`*^9, 3.577001694373336*^9}, {
   3.577001726223508*^9, 3.577001962789134*^9}, {3.577163587646381*^9, 
   3.5771636811866093`*^9}, {3.582002669513774*^9, 3.582002715299982*^9}, {
   3.58200304277591*^9, 3.582003100710557*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TP10percents", ">>", "\"\<reconstructions/TP10percents.mx\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.577180056186036*^9, 3.577180085446537*^9}, {
  3.5771845173727827`*^9, 3.577184519970025*^9}, {3.583658568737927*^9, 
  3.583658572386347*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TP10percents", "=", 
   RowBox[{"<<", "\"\<reconstructions/TP10percents.mx\>\""}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.577180056186036*^9, 3.577180085446537*^9}, {
  3.5771845173727827`*^9, 3.577184519970025*^9}, {3.583658568737927*^9, 
  3.583658572386347*^9}, {3.584256754490917*^9, 3.584256755895657*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tempSize", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempCC", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"TP10percents", ",", 
      RowBox[{"{", 
       RowBox[{"tempSize", ",", "tempCC", ",", "__"}], "}"}]}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", 
     RowBox[{"3", ";;"}]}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<cond. level\>\"", ",", "\"\<TP@10%FP\>\""}], "}"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.5771645007360573`*^9, 3.577164511760579*^9}, {
  3.577164568062418*^9, 3.577164652413766*^9}, {3.582003277939945*^9, 
  3.582003289100305*^9}, {3.582004142571858*^9, 3.582004187465641*^9}, {
  3.5820043071941357`*^9, 3.582004310446546*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tempSize", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"GraphicsRow", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Sort", "@", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"TP10percents", ",", 
           RowBox[{"{", 
            RowBox[{"tempSize", ",", "#", ",", "__"}], "}"}]}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", 
          RowBox[{"3", ";;"}]}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<cond. level\>\"", ",", "\"\<TP@10%FP\>\""}], "}"}]}]}], 
      "]"}], "&"}], "/@", "topoIndices"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", 
    RowBox[{"350", "*", 
     RowBox[{"Length", "[", "topoIndices", "]"}]}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.577164696348247*^9, 3.577164754154901*^9}, {
   3.577164790675047*^9, 3.577164818970825*^9}, 3.577165059030889*^9, {
   3.577168788526245*^9, 3.577168788691016*^9}, {3.5820122753367662`*^9, 
   3.582012278016494*^9}, 3.583660140782089*^9, {3.584252971130382*^9, 
   3.584253015691285*^9}}],

Cell[BoxData[
 RowBox[{"GraphicsGrid", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Sort", "@", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"TP10percents", ",", 
           RowBox[{"{", 
            RowBox[{"tempSize", ",", "topo", ",", "__"}], "}"}]}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", 
          RowBox[{"3", ";;"}]}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<cond. level\>\"", ",", "\"\<TP@10%FP\>\""}], "}"}]}], 
       ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"\"\<N = \>\"", "<>", 
         RowBox[{"ToString", "@", "tempSize"}], "<>", "\"\<, CC = \>\"", "<>", 
         RowBox[{"ToString", "@", "topo"}]}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"tempSize", ",", "networkSizes"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"topo", ",", "topoIndices"}], "}"}]}], "]"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", 
    RowBox[{"350", "*", 
     RowBox[{"Length", "[", "topoIndices", "]"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.584253038930956*^9, 3.584253223145103*^9}, {
  3.584253394856269*^9, 3.584253433913809*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"condLevels", "=", 
  RowBox[{"Union", "@", 
   RowBox[{"TP10percents", "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}]}]}]], "Input",
 CellChangeTimes->{{3.584256834908231*^9, 3.584256848484603*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.025`", ",", "0.05`", ",", "0.075`", ",", "0.1`", ",", "0.125`", ",", 
   "0.15`", ",", "0.175`", ",", "0.2`", ",", "0.225`", ",", "0.25`", ",", 
   "0.275`", ",", "0.3`", ",", "0.325`", ",", "0.35`", ",", "0.375`", ",", 
   "0.4`", ",", "0.425`", ",", "0.45`", ",", "0.475`", ",", "0.5`", ",", 
   "0.525`", ",", "0.55`", ",", "0.575`", ",", "0.6`", ",", "0.625`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.584256849093297*^9, 3.587387070595022*^9, 
  3.5877028069820423`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cond", "=", "0.3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xlines", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"TP10percents", ",", 
          RowBox[{"{", 
           RowBox[{"tempSize", ",", "topo", ",", "cond", ",", "_"}], "}"}]}], 
         "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "\[RightDoubleBracket]"}], ",", 
       "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"tempSize", ",", "networkSizes"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"topo", ",", "topoIndices"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"xlines", ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<CC\>\"", ",", "\"\<TP@10%FP\>\""}], "}"}]}], ",", 
   RowBox[{"GridLines", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "0.1", "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", 
    RowBox[{"\"\<all CHA reconstructions at cond = \>\"", "<>", 
     RowBox[{"ToString", "@", "cond"}]}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.58425679016611*^9, 3.584256816561078*^9}, {
  3.5842568796863832`*^9, 3.584256886213716*^9}, {3.5842570079410057`*^9, 
  3.584257036995145*^9}, {3.584257075227407*^9, 3.584257181594791*^9}, {
  3.587387080431786*^9, 3.587387081415598*^9}}],

Cell[BoxData[
 GraphicsBox[
  GraphicsComplexBox[{{0.1, 0.6080808080808081}, {0.2, 0.5689256198347108}, {
   0.30000000000000004`, 0.5130509641873278}, {0.4, 0.6172248803827751}, {0.5,
    0.6989304812834224}, {0.6000000000000001, 0.7469696969696971}, {0.1, 
   0.5466255357226958}, {0.2, 0.5990874180826142}, {0.30000000000000004`, 
   0.5202225416696995}, {0.4, 0.630783651311293}, {0.5, 0.8092420204820573}, {
   0.6000000000000001, 0.8581876995849553}, {0.1, 0.8530500740949862}, {0.2, 
   0.780464556138334}, {0.30000000000000004`, 0.8369573648477876}, {0.4, 
   0.900116249893863}, {0.5, 0.9356274309558243}, {0.6000000000000001, 
   0.936472085973834}}, {{{}, {}, 
     {Hue[0.67, 0.6, 0.6], LineBox[{1, 2, 3, 4, 5, 6}]}, 
     {Hue[0.9060679774997897, 0.6, 0.6], LineBox[{7, 8, 9, 10, 11, 12}]}, 
     {Hue[0.1421359549995791, 0.6, 0.6], LineBox[{13, 14, 15, 16, 17, 18}]}}, {
     {Hue[0.67, 0.6, 0.6], InsetBox[
       StyleBox["\<\"\[FilledCircle]\"\>",
        StripOnInput->False,
        FontSize->8.96], 1], InsetBox[
       StyleBox["\<\"\[FilledCircle]\"\>",
        StripOnInput->False,
        FontSize->8.96], 2], InsetBox[
       StyleBox["\<\"\[FilledCircle]\"\>",
        StripOnInput->False,
        FontSize->8.96], 3], InsetBox[
       StyleBox["\<\"\[FilledCircle]\"\>",
        StripOnInput->False,
        FontSize->8.96], 4], InsetBox[
       StyleBox["\<\"\[FilledCircle]\"\>",
        StripOnInput->False,
        FontSize->8.96], 5], InsetBox[
       StyleBox["\<\"\[FilledCircle]\"\>",
        StripOnInput->False,
        FontSize->8.96], 6]}, 
     {Hue[0.9060679774997897, 0.6, 0.6], InsetBox[
       StyleBox["\<\"\[FilledSquare]\"\>",
        StripOnInput->False,
        FontSize->8.96], 7], InsetBox[
       StyleBox["\<\"\[FilledSquare]\"\>",
        StripOnInput->False,
        FontSize->8.96], 8], InsetBox[
       StyleBox["\<\"\[FilledSquare]\"\>",
        StripOnInput->False,
        FontSize->8.96], 9], InsetBox[
       StyleBox["\<\"\[FilledSquare]\"\>",
        StripOnInput->False,
        FontSize->8.96], 10], InsetBox[
       StyleBox["\<\"\[FilledSquare]\"\>",
        StripOnInput->False,
        FontSize->8.96], 11], InsetBox[
       StyleBox["\<\"\[FilledSquare]\"\>",
        StripOnInput->False,
        FontSize->8.96], 12]}, 
     {Hue[0.1421359549995791, 0.6, 0.6], InsetBox[
       StyleBox["\<\"\[FilledDiamond]\"\>",
        StripOnInput->False,
        FontSize->10.88], 13], InsetBox[
       StyleBox["\<\"\[FilledDiamond]\"\>",
        StripOnInput->False,
        FontSize->10.88], 14], InsetBox[
       StyleBox["\<\"\[FilledDiamond]\"\>",
        StripOnInput->False,
        FontSize->10.88], 15], InsetBox[
       StyleBox["\<\"\[FilledDiamond]\"\>",
        StripOnInput->False,
        FontSize->10.88], 16], InsetBox[
       StyleBox["\<\"\[FilledDiamond]\"\>",
        StripOnInput->False,
        FontSize->10.88], 17], InsetBox[
       StyleBox["\<\"\[FilledDiamond]\"\>",
        StripOnInput->False,
        FontSize->10.88], 18]}, {}}}],
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  AxesOrigin->{0.1, 0},
  Frame->True,
  FrameLabel->{
    FormBox["\"CC\"", TraditionalForm], 
    FormBox["\"TP@10%FP\"", TraditionalForm]},
  GridLines->{{}, {0.1}},
  ImageMargins->5,
  LabelStyle->Directive[
   FontFamily -> "Helvetica", FontSize -> 17, ImageMargins -> 8],
  PlotLabel->FormBox[
   "\"all CHA reconstructions at cond = 0.3\"", TraditionalForm],
  PlotRange->{{0.1, 0.6000000000000001}, {0, 1}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], Automatic}]], "Output",
 CellChangeTimes->{{3.5842570248343554`*^9, 3.584257037910285*^9}, {
   3.584257077394478*^9, 3.584257120844425*^9}, {3.584257157543888*^9, 
   3.584257182143672*^9}, 3.5873870819154053`*^9, 3.5877028093703823`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
For a specific cond. level, select reconstructions and export ROC curves\
\>", "Subsection",
 CellChangeTimes->{{3.5877028240257387`*^9, 3.5877028519255447`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"xCondLevel", "=", "cond"}]], "Input",
 CellChangeTimes->{{3.587702864618456*^9, 3.587702864864259*^9}, {
  3.587702947948083*^9, 3.587702950627688*^9}}],

Cell[BoxData["0.3`"], "Output",
 CellChangeTimes->{3.5877028656930723`*^9, 3.587702951378778*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ROCsList", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"recFiles", "=", 
    RowBox[{"Sort", "@", 
     RowBox[{"FileNames", "[", "\"\<reconstructions/adjA*.mx\>\"", "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fileIndex", "=", 
      RowBox[{"ToExpression", "@", 
       RowBox[{"StringTrim", "[", 
        RowBox[{"recFileName", ",", 
         RowBox[{
          RowBox[{"Except", "[", "DigitCharacter", "]"}], "..."}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pars", "=", 
      RowBox[{"Get", "[", 
       RowBox[{"\"\<reconstructions/pars_iteration\>\"", "<>", 
        RowBox[{"ToString", "[", "fileIndex", "]"}], "<>", "\"\<.mx\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"s", "=", 
      RowBox[{
       RowBox[{"Symbol", "[", "\"\<size\>\"", "]"}], "/.", "pars"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"the", " ", "following", " ", "assumes", " ", "a", " ", 
         RowBox[{"fluoro", ".", " ", "file"}], " ", "name", " ", "format", 
         " ", "ending", " ", "in"}], " ", "..."}], 
       RowBox[{"_CC01", ".", "txt"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"cc", "=", 
      RowBox[{"0.1", "*", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Symbol", "[", "\"\<inputfile\>\"", "]"}], "/.", "pars"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"-", "5"}], "}"}]}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cond", "=", 
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{"Symbol", "[", "\"\<GlobalConditioningLevel\>\"", "]"}], "/.",
         "pars"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"cond", "\[Equal]", "xCondLevel"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<analyzing \>\"", ",", "recFileName", ",", "\"\< (s = \>\"", ",",
           "s", ",", "\"\<, cc = \>\"", ",", "cc", ",", "\"\<, cond = \>\"", 
          ",", "cond", ",", "\"\<) ...\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"trueadjA", "=", 
         RowBox[{"Last", "@", 
          RowBox[{"First", "@", 
           RowBox[{"Cases", "[", 
            RowBox[{"trueadjAs", ",", 
             RowBox[{"{", 
              RowBox[{"s", ",", "cc", ",", "__"}], "}"}]}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"xadjA", "=", 
         RowBox[{"Get", "[", "recFileName", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"take", " ", "lowest", " ", "global", " ", "bin"}], ",", 
          " ", 
          RowBox[{
          "if", " ", "more", " ", "than", " ", "one", " ", "is", " ", 
           "available"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", 
            RowBox[{"Dimensions", "@", "xadjA"}]}], ">", "2"}], ",", 
          RowBox[{"xadjA", "=", 
           RowBox[{"xadjA", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "All", ",", "1"}], 
            "\[RightDoubleBracket]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"ROCsList", ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "cc", ",", "cond", ",", 
            RowBox[{"xroc", "=", 
             RowBox[{"CleanUpROCs", "@", 
              RowBox[{"GenerateROCsmart", "[", 
               RowBox[{"xadjA", ",", "trueadjA"}], "]"}]}]}]}], "}"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"exportName", "=", 
         RowBox[{"\"\<roc_curves/roc_iNet1_Size\>\"", "<>", 
          RowBox[{"ToString", "[", "s", "]"}], "<>", "\"\<_CC0\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Round", "[", 
            RowBox[{"cc", "*", "10"}], "]"}], "]"}], "<>", "\"\<.csv\>\""}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{"exportName", ",", "xroc"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"recFileName", ",", "recFiles"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "fileIndex", ",", "pars", ",", "s", ",", "cc", ",", "cond", ",", 
    "trueadjA", ",", "xadjA", ",", "xroc", ",", "exportName"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.576992573702709*^9, 3.576993078200306*^9}, {
   3.576993194877028*^9, 3.576993208798905*^9}, {3.576993245766613*^9, 
   3.576993269500984*^9}, {3.577001497824472*^9, 3.577001581429282*^9}, 
   3.577001643195665*^9, {3.5770016924454193`*^9, 3.577001694373336*^9}, {
   3.577001726223508*^9, 3.577001962789134*^9}, {3.577163587646381*^9, 
   3.5771636811866093`*^9}, {3.582002669513774*^9, 3.582002715299982*^9}, {
   3.58200304277591*^9, 3.582003100710557*^9}, {3.587702887163472*^9, 
   3.587703017541601*^9}, {3.587703394566427*^9, 3.587703395756405*^9}, {
   3.587703437140544*^9, 3.587703596977302*^9}, 3.5877043430182257`*^9}]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->None,
WindowToolbars->{},
WindowSize->{948, 734},
WindowMargins->{{129, Automatic}, {Automatic, 61}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 23, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 200, 3, 67, "Section",
 InitializationGroup->True],
Cell[782, 27, 19839, 459, 1209, "Input",
 InitializationGroup->True],
Cell[20624, 488, 1161, 31, 88, "Input"],
Cell[21788, 521, 5162, 120, 328, "Input",
 InitializationGroup->True],
Cell[26953, 643, 3318, 91, 125, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[30308, 739, 256, 5, 37, "Section"],
Cell[CellGroupData[{
Cell[30589, 748, 108, 1, 24, "Subsubsection"],
Cell[30700, 751, 8597, 127, 88, "Input"],
Cell[CellGroupData[{
Cell[39322, 882, 195, 4, 27, "Input"],
Cell[39520, 888, 1313, 39, 43, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[40882, 933, 119, 1, 24, "Subsubsection"],
Cell[41004, 936, 2805, 69, 268, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43846, 1010, 132, 3, 24, "Subsubsection"],
Cell[43981, 1015, 4510, 112, 388, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[48540, 1133, 259, 5, 37, "Section"],
Cell[CellGroupData[{
Cell[48824, 1142, 108, 1, 24, "Subsubsection"],
Cell[48935, 1145, 8597, 127, 88, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57569, 1277, 119, 1, 24, "Subsubsection"],
Cell[57691, 1280, 2805, 69, 268, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60533, 1354, 203, 4, 24, "Subsubsection"],
Cell[60739, 1360, 4845, 120, 388, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[65621, 1485, 208, 4, 18, "Subsubsection"],
Cell[65832, 1491, 5351, 131, 403, "Input"],
Cell[71186, 1624, 286, 6, 27, "Input"],
Cell[71475, 1632, 351, 7, 27, "Input"],
Cell[71829, 1641, 1054, 25, 73, "Input"],
Cell[72886, 1668, 1413, 34, 88, "Input"],
Cell[74302, 1704, 1505, 37, 88, "Input"],
Cell[CellGroupData[{
Cell[75832, 1745, 257, 5, 27, "Input"],
Cell[76092, 1752, 523, 10, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76652, 1767, 1775, 46, 88, "Input"],
Cell[78430, 1815, 3809, 89, 277, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[82288, 1910, 172, 3, 34, "Subsection"],
Cell[CellGroupData[{
Cell[82485, 1917, 176, 3, 27, "Input"],
Cell[82664, 1922, 97, 1, 27, "Output"]
}, Open  ]],
Cell[82776, 1926, 5542, 128, 418, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
